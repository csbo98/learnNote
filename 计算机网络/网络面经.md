# 网络面经



## select、poll、epoll

三种技术通常与非阻塞IO同时使用，但是也可以与阻塞式IO一起使用。

### 区别

1. select默认情况下最多只能监听1024个文件描述符，而且描述符集合既是入参，同时也是出参。poll和epoll没有文件描述符数量的限制。
2. poll每次检测之后的结果不会修改原来的传入值，而是把结果保留在revents字段中，因此不需要每次检测完都重置待检测的描述符和感兴趣的事件。
3. poll和select在内核中的实现本质上是相似的
4. epoll避免了用户态 - 内核态频繁的数据拷贝，大大提高了系统性能；select和poll的可扩展性很差，随着描述符数量的增加，CPU时间也会显著增加，而epoll则具有很好的可扩展性，处理10个描述符的CPU开销和处理10000个描述符的时间开销相差不大，而且远低于select和poll。

### epoll

在非阻塞IO的前提下，epoll边缘触发模式需要持续的读数据，一直读到EAGAIN；accept同样需要持续的从队列取出新的连接直到EAGAIN。「If the socket is marked nonblocking and no pending connections are the queue, accept() fails with the error EAGAIN or EWOULDBLOCK.」

